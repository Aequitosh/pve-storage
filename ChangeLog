2011-08-18  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (iscsi_login): login to target, instead of
	portal-  to make it work when one portal is offline.

2011-08-15  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (parse_config): fix parser for files without
	newline at eof

2011-08-12  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (scan_usb): imp.

2011-08-05  Proxmox Support Team  <support@proxmox.com>

	* changelog.Debian: increase release number to 2.0-4

	* PVE/Storage.pm (iscsi_device_list): return numeric values for
	channel/ID/LUN

2011-08-01  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (iscsi_test_portal): factor out code to test if
	portal in online (use 2 seconds timeout).
	(iscsi_discovery): test if portal is online using
	iscsi_test_portal(). This avoids that we run int a timeout (iscsi
	default timeout is 15 seconds, we now use 2 seconds)
	(cluster_lock_storage): fix cfs_lock_file() arguments,
	(lock_storage_config): use default timeout (10)

	* PVE/API2/Storage/Config.pm: s/resolv_portal_dns/resolv_portal/
	(delete) do not call deactivate_storage(), because we likely run
	into timeouts.

	* PVE/Storage.pm (resolv_portal_dns): remove duplicate (use resolv_portal instead)
	(resolv_portal): use resolv_server()

	* PVE/API2/Storage/Scan.pm: remove unneccessary call to resolv_portal_dns()

	* PVE/Storage.pm (iscsi_login): use Net::Ping to check portal
	availability (avoid long iscsi login timeouts)
	(resolv_portal_dns): use resolv_server()

2011-07-29  Proxmox Support Team  <support@proxmox.com>

	* changelog.Debian: update version to 2.0-3

	* PVE/API2/Storage/Config.pm: activate base storage before we try
	to create the VG. Make 'nodes' optional.

2011-07-28  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (storage_check_node): check if storage is
	available on a specific node.
	(storage_check_enabled): check if storage is
	available on the local node.
	
	* PVE/API2/Storage/Config.pm (create): add 'nodes' options, do not
	activate storage automatically.
	
	* PVE/API2/Storage/Config.pm (update): add 'nodes' options, do not
	activate storage automatically.

	* pvesm (lock): removed - we do not use the central lock manager
	anymore.

	* PVE/Storage.pm (vdisk_alloc): use run_command() in order to get
	better error messages.

2011-07-27  Proxmox Support Team  <support@proxmox.com>

	* PVE/API2/Storage/Config.pm (create): add option 'base' 

2011-07-26  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (verify_portal_dns): new type
	'pve-storage-portal-dns', which allows to use a DNS name.
	(resolv_portal_dns): helper to convert portal with DNS name to IP address.

	* PVE/API2/Storage/Config.pm: 'target' can be arbitrary string (we
	do not check format for now)

	* PVE/API2/Storage/Scan.pm (iscsiscan): rename 'server' to 'portal'

2010-11-08  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (iscsi_login): multipath fixes: try to log in to all
	portals (backport from stable)

2010-10-28  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (iscsi_session_list): allow several sessions per
	target (multipath)(backport from stable). 
	(iscsi_session_rescan): rescan all sessions (backport from stable)

2010-09-13  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (storage_info): cache VGs, mountdata and iSCSI
	session list (backport from stable)

2010-05-06  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (storage_migrate): use --sparse and --whole-file,
	this alsocreates sparse files (backport from stable)

2011-07-22  Proxmox Support Team  <support@proxmox.com>

	* PVE/API2/Storage/Scan.pm: split scan into three different
	methods with divverent return values

2011-07-21  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (storage_info): do not list disabled storages

2011-05-06  Proxmox Support Team  <support@proxmox.com>

	* PVE/API2/Storage/Status.pm: impl. content filter

	* PVE/Storage.pm (storage_info): include content type

2011-04-04  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (load_stable_scsi_paths): only load
	/dev/disk/by-id once (avoid delays when we have many disks)

2011-03-09  Proxmox Support Team  <support@proxmox.com>

	* pvesm (status): report sizes like 'df'

	* PVE/Storage.pm (file_size_info): allow to pass timeout
	(important when NFS server is down)
	(__activate_storage_full): avoid call to mkpath if not necessary
	- avoid hang when NFS server is offline
	(storage_info): return sizes in bytes
	(storage_info): use PVE::Tools::df with timeout
	(lvm_vgs): use '--units b' (report size in bytes)
	(lvm_lvs): use '--units b' (report size in bytes)
	(file_size_info): report size in bytes

	* control.in (Depends): remove libfilesys-df-perl

2011-03-08  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm (__activate_storage_full): avoid to create empty
	content config

2011-02-11  Proxmox Support Team  <support@proxmox.com>

	* PVE/API2/*: cleanup API Object hierarchiy

	* PVE/API2/Storage.pm: removed (no longer needed)

2011-01-25  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm:  use new cfs_read_file/cfs_write_file everywhere
	(cluster filesystem support)

2010-11-08  Proxmox Support Team  <support@proxmox.com>

	* PVE/Storage.pm: moved hostname read/write to INotify.pm

2010-09-14  Proxmox Support Team  <support@proxmox.com>

	* pvesm: add/use 'verifyapi' command

	* Storage.pm (storage_info): better caching - avoid timeout bug
	with large number of VGs.

2010-09-07  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (parse_options): renamed from parse_options_new

2010-08-26  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (vdisk_list): return full volid instead of volume name.
	(template_list): return full volid instead of volume name.
	(foreach_volid): re-add, slightly modified

2010-08-25  Proxmox Support Team  <support@proxmox.com>

	* pvesm: use new PVE::CLIHandler

	* PVE/API2/Storage.pm: create extra upload method, because this
	have different 'proxy' requirements that normal 'create'

2010-08-24  Proxmox Support Team  <support@proxmox.com>

	* pvesm: use new PVE::RPCEnvironment

	* PVE/API2/*.pm: remove $conn parameter everywhere

2010-08-19  Proxmox Support Team  <support@proxmox.com>

	* pvesm: more cleanups - use new API calls

2010-08-17  Proxmox Support Team  <support@proxmox.com>

	* API2::Storage.pm: moved from pve-manager

	* split API::Storage into different files
	
2010-08-16  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (file_read_firstline): import from PVE::Tools

	* Storage.pm: use new INotify class

	* Storage.pm (lock_config): renamed to lock_storage_config, use
	lock_file from PVE::Utils

	* control.in (Depends): add libpve-common-perl

2010-07-16  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (parse_options): added ability to verify a
	HASH (needed by REST API)

2010-01-25  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (parse_lvm_name, parse_storage_id, parse_volume_id):
	fix regex (allow 2 character names)

2010-01-18  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (iscsi_device_list): fix for kernel 2.6.32

2009-10-29  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (parse_volume_id): ignore case.

2009-10-27  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (parse_volume_id): correctly parse storage id.

2009-10-19  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (storage_migrate): flush output.

2009-10-08  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (path): use  parse_volume_id()
	(template_list): list backup files too

2009-10-07  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (cluster_lock_storage): dont use ssh for local
	request (master = localhost)

2009-09-18  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (storage_remove): do not remove storage which is used
	as base for other storage.

2009-09-04  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (lvm_create_volume_group): don't set clustered flag
	(vdisk_alloc): a better way to create unique disk names

2009-08-21  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (activate_storage_list): only call udevsettle when
	there are events. openvz container start/stop sometimes increases
	event counter, but deliver no events. So udevsettle simply
	hangs. Above optimization eliminate that bug in 99%.

2009-08-20  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (cluster_lock_storage): implemented simply central
	cluster lock manager.

2009-08-18  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (iscsi_session_rescan): do not rescan uscsi too often
	(wait at leaset 10 seconds).
	(parse_storage_id): allow captial letters.

2009-08-13  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm: use arrays instead of hash to return lists (SOAP
	compatibility)
	(foreach_volid): new helper method
	(storage_migrate): first try

2009-07-20  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (target_is_used): new function

2009-07-03  Proxmox Support Team  <support@proxmox.com>

	* Storage.pm (activate_storage_list): only call udev settle when
	necessary (else it hangs sometimes)

